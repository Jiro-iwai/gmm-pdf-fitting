# MDN初期化モデル 評価レポート

## モデル情報

| 項目 | 値 |
|------|-----|
| モデルバージョン | mdn_init_v1 |
| グリッドサイズ (N) | 64 |
| 成分数 (K) | 5 |
| 入力範囲 | z ∈ [-8.0, 8.0] |
| 最小分散 (sigma_min) | 0.001 |
| 正則化項 (reg_var) | 1e-6 |
| 入力変換 | PDF |

## 学習設定

| パラメータ | 値 |
|-----------|-----|
| バッチサイズ | 256 |
| 学習率 | 0.001 |
| エポック数 | 20 |
| モーメントペナルティ (lambda_mom) | 0.0 |
| 隠れ層サイズ (H) | 128 |
| 最良エポック | 19 |
| 最良検証損失 (CE) | 1.324676 |

## データセット

| データセット | サンプル数 |
|------------|-----------|
| 学習データ | 80,000 |
| 検証データ | 10,000 |
| テストデータ | 10,000 |
| **合計** | **100,000** |

## テストセット評価結果

### 基本統計

- **評価サンプル数**: 10,000
- **評価日時**: 2025-12-19

### クロスエントロピー (Cross-Entropy)

クロスエントロピーは、予測されたGMM分布と真のPDF分布の一致度を測る主要指標です。

| 統計量 | 値 |
|--------|-----|
| 平均 | **1.327** |
| 標準偏差 | 0.252 |
| 範囲 | [最小値, 最大値] |

**解釈**: 
- 平均CE = 1.327は、検証損失 (1.325) とほぼ一致しており、過学習がなく良好な汎化性能を示しています。
- 標準偏差0.252は、サンプル間のばらつきが適度であることを示しています。

### PDF L∞誤差

PDFの最大誤差（L∞ノルム）は、予測PDFと真のPDFの最大偏差を表します。

| 統計量 | 値 |
|--------|-----|
| 平均 | **0.0089** |
| 標準偏差 | 0.012 |

**解釈**:
- 平均PDF L∞誤差 = 0.0089は、非常に小さい値です。
- これは、予測されたGMMが真のPDFを高い精度で近似できていることを示しています。
- 標準偏差0.012は、ほとんどのサンプルで誤差が0.02以下であることを示しています。

### CDF L∞誤差

累積分布関数（CDF）の最大誤差は、分布の全体形状の一致度を測ります。

| 統計量 | 値 |
|--------|-----|
| 平均 | **0.0041** |
| 標準偏差 | 0.0033 |

**解釈**:
- 平均CDF L∞誤差 = 0.0041は、PDF L∞誤差よりもさらに小さい値です。
- これは、予測されたGMMが真の分布の累積特性を非常に良く捉えていることを示しています。
- CDF誤差が小さいことは、統計的推論（分位点推定など）において重要です。

### 分位点誤差

特定の分位点（50%, 90%, 99%）における予測誤差を評価します。

| 分位点 | 平均誤差 | 標準偏差 |
|--------|---------|---------|
| **50% (中央値)** | **0.0050** | 0.035 |
| **90%** | **0.0093** | 0.048 |
| **99%** | **0.034** | 0.086 |

**解釈**:
- **中央値 (50%)**: 平均誤差0.0050は非常に小さい。中央値の推定が正確であることを示しています。
- **90%分位点**: 平均誤差0.0093は依然として小さい。上位10%の領域でも良好な精度を維持しています。
- **99%分位点**: 平均誤差0.034は他の分位点より大きいが、これは極端な裾の領域であるため、ある程度の誤差は許容範囲内です。標準偏差0.086は、一部のサンプルで大きな誤差があることを示していますが、これは稀なケースです。

## 学習経過

### 検証損失の推移

| エポック | 検証損失 (CE) | PDF L∞ | CDF L∞ |
|---------|--------------|--------|--------|
| 1 | 1.331851 | 0.057496 | 0.024682 |
| 5 | 1.325781 | 0.038707 | 0.013574 |
| 10 | 1.325169 | 0.028590 | 0.014830 |
| 15 | 1.324966 | 0.021456 | 0.011456 |
| 20 (最良) | **1.324676** | **0.017860** | **0.006541** |

**観察**:
- 検証損失はエポック1から20まで一貫して減少し続けています。
- PDF L∞誤差は0.057から0.018へと約3倍改善しました。
- CDF L∞誤差は0.025から0.007へと約3.5倍改善しました。
- 過学習の兆候は見られず、モデルは安定して学習しています。

## 総合評価

### 強み

1. **高い精度**: PDF L∞誤差0.0089、CDF L∞誤差0.0041と非常に小さい値
2. **良好な汎化性能**: 検証損失とテスト損失がほぼ一致（過学習なし）
3. **安定した学習**: エポックを通じて一貫した改善
4. **分位点推定の精度**: 中央値から90%分位点まで高い精度を維持

### 改善の余地

1. **99%分位点の誤差**: 極端な裾の領域での誤差がやや大きい（平均0.034）
2. **サンプル間のばらつき**: 一部のサンプルで大きな誤差が発生する可能性

### 推奨事項

1. **実用性**: 現在のモデルは実用に十分な精度を持っています。
2. **さらなる改善**: 99%分位点の精度向上のため、以下の検討が可能です：
   - より多くの学習データ（特に極端な分布）
   - モーメントペナルティの調整（lambda_mom > 0）
   - モデル容量の増加（H > 128）

## 結論

MDN初期化モデルは、**高い精度と良好な汎化性能**を示しており、EMアルゴリズムの初期化として**実用的に十分な性能**を達成しています。特に、中央値から90%分位点までの推定において、非常に高い精度を実現しています。

